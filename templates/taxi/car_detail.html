{% extends "base.html" %}

{% block content %}
  <h1>
    {{ car.model }}

    <span class="float-right">
      <a href="{% url 'taxi:car-update' pk=car.id %}" class="btn btn-outline-secondary">
        <i class="bi bi-pencil-square"></i> Update
      </a>
      <a href="{% url 'taxi:car-delete' pk=car.id %}" class="btn btn-outline-danger">
        <i class="bi bi-trash"></i> Delete
      </a>
    </span>
  </h1>
  <p>
    <span class="font-weight-bold">Manufacturer: </span>{{ car.manufacturer.name }}
    <br>
    <span class="font-weight-bold">Country: </span>{{ car.manufacturer.country }}
  </p>

  {% if car.drivers.all %}
    <h3>
      Drivers:

      <span class="float-right">
        {% if user in car.drivers.all %}
          <a href="{% url 'taxi:toggle-car-assign' pk=car.id %}" class="btn btn-outline-danger">
            <i class="bi bi-person-x-fill"></i> Delete me from this car
          </a>
        {% else %}
          <a href="{% url 'taxi:toggle-car-assign' pk=car.id %}" class="btn btn-outline-success">
            <i class="bi bi-person-plus-fill"></i> Assign me to this car
          </a>
        {% endif %}
      </span>
    </h3>

    {% for driver in car.drivers.all %}
      <hr>
      <h5><a href="{% url 'taxi:driver-detail' pk=driver.id %}">{{ driver.username }}</a></h5>
      <p>
        <span class="font-weight-bold">License number: </span>{{ driver.license_number }}
        <br>
        <span class="font-weight-bold">First name: </span>{{ driver.first_name }}
        <br>
        <span class="font-weight-bold">Last name: </span>{{ driver.last_name }}
        <br>
        <span class="font-weight-bold">Email: </span>{{ driver.email }}
      </p>
      {% if forloop.last %}<hr>{% endif %}
    {% endfor %}

  {% else %}
    <p class="text-muted">This car has no drivers.</p>
  {% endif %}

  <br>

{% endblock %}
