{% extends "base.html" %}
{% load bootstrap_icons %}

{% block content %}
  <div class="d-flex justify-content-between align-items-center subtitle">
    <h2>Car Info</h2>
      
    <form method="post" action="{% url 'taxi:car-detail' pk=car.pk %}">
      {% csrf_token %}
      <input type="hidden" name="action" value="{% if user in car.drivers.all %}delete{% else %}assign{% endif %}">
      <button type="submit" class="btn {% if user in car.drivers.all %}btn-danger{% else %}btn-primary{% endif %}">
        {% if user in car.drivers.all %}Delete Me{% else %}Assign Me{% endif %}
      </button>
    </form>
  </div>
  
  {% if car %}
    <p><strong>Model:</strong> {{ car.model }}</p>
    <p><strong>Manufacture:</strong> {{ car.manufacturer.name }}</p>
    <p><strong>Country:</strong> {{ car.manufacturer.country }}</p>
    <p><strong>Drivers:</strong></p>
      {% for driver in car.drivers.all %}
        <p class="ml-3">
          <a href="{{ driver.get_absolute_url }}">
            {{ driver.first_name }} {{ driver.last_name }} (License: {{ driver.license_number }})
          </a>
        </p>
        
        {% empty %}
        <p>No data</p>
      {% endfor %}
    
    {% else %}
    <p>No data</p>
  {% endif %}
{% endblock %}
